# Spec Writer Skill 使用说明

## 📋 概述

**Spec Writer** 是一个专门为 AI+专业评估系统项目设计的 Claude Code Skill，用于规范化地创建技术规格文档（Spec）。

## 🎯 核心功能

1. **分类目录管理**：Spec 按类型放入 01-06 分类目录
2. **文件夹组织**：每个 Spec 任务创建独立的文件夹
3. **统一命名规范**：文件夹格式为 `YYYYMMDD-任务描述`
4. **双文档结构**：`plan.md`（计划）+ `summary.md`（总结）
5. **自动归档**：执行完成后自动移动到 `06-已归档`
6. **标准化模板**：提供多种类型的 Spec 模板
7. **质量检查**：内置检查清单确保文档质量

## 📁 分类目录结构

### 目录说明

| 目录 | 名称 | 用途 | 适用场景 |
|------|------|------|----------|
| `01-项目规划` | 项目规划 | 项目整体规划、PRD、流程设计 | 新项目启动、功能规划 |
| `02-架构设计` | 架构设计 | 系统架构、数据模型、服务层设计 | 架构设计、数据结构 |
| `03-功能实现` | 功能实现 | 具体功能的实现方案 | 新功能开发、API、集成 |
| `04-问题修复` | 问题修复 | Bug 修复、问题解决方案 | Bug 修复、重构 |
| `05-测试文档` | 测试文档 | 测试计划、测试报告 | 测试准备、测试总结 |
| `06-已归档` | 已归档 | 已完成的 Spec | 自动归档（由 spec-executor 移动） |

### 完整目录结构

```
spec/
├── 01-项目规划/
│   ├── PRD-AI专业评估系统.md
│   └── 【流程】AI+专业评估.md
├── 02-架构设计/
│   ├── 20251231-framework-service-design/
│   │   ├── plan.md
│   │   └── summary.md
│   └── 20251231-数据模型设计/
│       ├── plan.md
│       └── summary.md
├── 03-功能实现/
│   ├── 20251231-专业评价Agent设计/
│   │   ├── plan.md
│   │   └── summary.md
│   └── 20251231-api-specification/
│       └── plan.md
├── 04-问题修复/
│   ├── 20251231-websocket-fix/
│   │   ├── plan.md
│   │   └── summary.md
│   └── 20251231-scoring-bug-fix/
│       └── plan.md
├── 05-测试文档/
│   └── 20251231-integration-test/
│       └── plan.md
└── 06-已归档/
    └── 20251231-completed-feature/
        ├── plan.md
        └── summary.md
```

## 🚀 快速开始

### 1. 激活 Skill

在 Claude Code 中，当你需要创建 Spec 文档时，Skill 会自动激活。你也可以明确提及：

```
请使用 spec-writer 创建一个关于 XXX 的设计文档
```

### 2. 触发关键词

以下关键词会触发此 Skill：

- "创建 Spec"
- "撰写设计文档"
- "写一个技术规格"
- "设计方案"
- "API 规范"
- "数据模型设计"
- "架构设计"
- "重构方案"

### 3. 基本使用

**示例 1：创建功能设计文档**

```
用户：帮我创建一个专业评价 Agent 的设计文档

Claude：我将使用 spec-writer Skill 为你创建设计文档。

[Claude 会：]
1. 理解需求
2. 确定文档类型：功能设计 → 目标目录：03-功能实现
3. 创建文件夹：spec/03-功能实现/20251231-专业评价Agent设计/
4. 使用功能设计模板
5. 撰写完整的 plan.md 内容
6. 保存到 spec/03-功能实现/20251231-专业评价Agent设计/plan.md
7. 说明执行后会创建 summary.md
8. 说明执行完成后会归档到 06-已归档
9. 等待你的确认
```

**示例 2：创建 Bug 修复方案**

```
用户：写一个 WebSocket 连接问题的修复方案

Claude：我将创建修复方案文档。

[目标目录：04-问题修复]
[生成文件夹：spec/04-问题修复/20251231-websocket-fix/]
[生成文件：spec/04-问题修复/20251231-websocket-fix/plan.md]
```

**示例 3：创建架构设计文档**

```
用户：设计一个新的数据模型架构

Claude：我将创建架构设计文档。

[目标目录：02-架构设计]
[生成文件夹：spec/02-架构设计/20251231-data-model-architecture/]
[生成文件：spec/02-架构设计/20251231-data-model-architecture/plan.md]
```

## 📝 文档类型与分类对应

| 文档类型 | 目标目录 | 文件夹命名示例 |
|---------|----------|--------------|
| 项目规划 | `01-项目规划` | `20251231-project-planning/` |
| PRD | `01-项目规划` | `20251231-feature-prd/` |
| 架构设计 | `02-架构设计` | `20251231-architecture-design/` |
| 数据模型 | `02-架构设计` | `20251231-data-model-design/` |
| 服务层设计 | `02-架构设计` | `20251231-service-layer-design/` |
| 功能设计 | `03-功能实现` | `20251231-feature-design/` |
| API 规范 | `03-功能实现` | `20251231-api-specification/` |
| 集成方案 | `03-功能实现` | `20251231-integration-plan/` |
| 修复方案 | `04-问题修复` | `20251231-bug-fix-spec/` |
| 重构方案 | `04-问题修复` | `20251231-refactor-plan/` |
| 测试计划 | `05-测试文档` | `20251231-test-plan/` |
| 测试报告 | `05-测试文档` | `20251231-test-report/` |

## 🔄 工作流程

### 标准流程

```
1. 理解需求和背景
   ↓
2. 确定文档类型和目标分类目录（01-05）
   ↓
3. 确定文件夹命名（YYYYMMDD-任务描述）
   ↓
4. 创建 Spec 文件夹（在分类目录下）
   ↓
5. 选择合适的模板
   ↓
6. 撰写 plan.md 内容
   ↓
7. 验证文件路径和命名
   ↓
8. 保存到 spec/分类目录/任务文件夹/plan.md
   ↓
9. 说明 summary.md 将在执行后创建
   ↓
10. 说明执行完成后会归档到 06-已归档
   ↓
11. 等待用户确认
```

### 检查清单

在保存 Spec 前，确认：

- [ ] 已选择正确的分类目录（01-05）
- [ ] 文件夹已创建在 `spec/分类目录/` 下
- [ ] 文件夹名格式：`YYYYMMDD-任务描述`
- [ ] 日期是今天的日期
- [ ] 任务描述简洁明确
- [ ] plan.md 文件已创建
- [ ] 使用了合适的模板
- [ ] 包含所有必要的技术细节
- [ ] 设计决策有明确依据
- [ ] 提供了具体的实现步骤
- [ ] 已告知用户 summary.md 将在执行后创建
- [ ] 已告知用户执行完成后会归档到 `06-已归档`

## 📁 文件夹命名规范

### 格式

`YYYYMMDD-任务描述`

### 组成部分

1. **日期**（8位数字）
   - 格式：YYYYMMDD
   - 示例：20251231
   - 说明：使用创建文档的日期

2. **分隔符**
   - 使用连字符 `-`

3. **任务描述**
   - 使用中文或英文
   - 简洁明确，说明这个 Spec 的作用
   - 多个单词用连字符分隔
   - 示例：`专业评价Agent设计`、`api-specification`

### 命名示例

✅ **正确的命名**：
```
spec/02-架构设计/20251231-framework-service-design/plan.md
spec/03-功能实现/20251231-专业评价Agent设计/plan.md
spec/04-问题修复/20251231-websocket-fix/plan.md
spec/05-测试文档/20251231-integration-test/plan.md
```

❌ **错误的命名**：
```
spec/20251231-design/plan.md                    # 未放入分类目录
spec/20251231-design.md                         # 直接在 spec/ 下
spec/02-架构设计/design/plan.md                 # 缺少日期
spec/02-架构设计/2025-12-31-design/plan.md     # 日期格式错误
spec/02-架构设计/20251231_design/plan.md       # 分隔符错误
```

## ⚠️ 重要约束

### 开发顺序

根据项目的 `CLAUDE.md` 要求：

1. **先创建 Spec，用户确认后再开发**
2. **开发顺序**：Framework 服务层 → Agent 层 → API 层
3. **严格遵循 Spec**：不允许做任何与 Spec 无关的开发
4. **修改需要新 Spec**：任何修改和修复都需要先创建 Spec 等待用户确认

### 禁止的操作

❌ **不要做**：
- 在 Spec 确认前开始编写代码
- 直接在 spec/ 目录下创建文件夹（必须放入分类目录）
- 直接在分类目录下创建 .md 文件（必须创建任务文件夹）
- 使用错误的文件命名格式
- 添加 Spec 中未定义的功能
- 跳过用户确认步骤
- 手动将 Spec 移动到 `06-已归档`（由 spec-executor 完成）

✅ **应该做**：
- 先理解需求，再撰写 Spec
- 根据 Spec 类型选择正确的分类目录（01-05）
- 在分类目录下创建独立的任务文件夹
- 使用标准模板确保一致性
- 包含足够的技术细节
- 提供清晰的实现步骤
- 说明 summary.md 将在执行后创建
- 说明执行完成后会归档到 `06-已归档`
- 等待用户确认后再开发

## 📚 资源文件

### SKILL.md
主 Skill 文件，包含：
- 核心规则
- 分类目录说明
- 工作流程
- 项目特定要求
- 快速参考

### TEMPLATES.md
模板文件，包含：
- 功能设计模板
- API 规范模板
- 数据模型模板
- 架构设计模板
- 重构方案模板

### EXAMPLES.md
示例文件，包含：
- 专业评价 Agent 设计示例
- 评估任务 API 示例
- 评估结果模型示例

### README.md（本文件）
使用说明，包含：
- 快速开始
- 分类目录说明
- 文件命名规范
- 文档类型说明
- 工作流程
- 重要约束

## 🎓 最佳实践

### 1. 选择正确的分类目录

根据 Spec 的主要目的选择目录：

| 如果你要... | 选择目录 |
|------------|----------|
| 规划新项目或功能 | `01-项目规划` |
| 设计架构或数据模型 | `02-架构设计` |
| 实现具体功能或 API | `03-功能实现` |
| 修复 Bug 或重构代码 | `04-问题修复` |
| 编写测试计划或报告 | `05-测试文档` |

### 2. 明确性优先

**好的示例**：
```markdown
## 2.1 功能需求

### FR-001: 评估指标解析

**描述**：解析评估指标体系，提取评分标准和权重

**输入**：
- Framework JSON（评估指标体系）

**输出**：
- 结构化的评估指标列表
- 每个指标的评分规则和权重

**业务规则**：
1. 必须支持多层级指标体系
2. 权重总和必须为 1.0
3. 评分规则必须明确可执行
```

**不好的示例**：
```markdown
## 功能

解析指标体系
```

### 3. 可追溯性

在数据模型设计中，明确标注：
- 哪些字段是系统预设的
- 哪些字段是 Agent 填写的
- 数据的流转路径

**示例**：
```python
class EvaluationResult(BaseModel):
    # 系统预设字段
    id: str = Field(description="唯一标识符，系统生成")
    created_at: datetime = Field(description="创建时间，系统生成")

    # Agent 填写字段
    score: float = Field(description="分数，Agent填写")
    evaluation_basis: str = Field(description="评价依据，Agent填写")
```

## 🔧 故障排除

### 问题 1：Skill 没有激活

**症状**：创建的文档不在正确的分类目录或命名格式不对

**解决方案**：
1. 明确提及 "使用 spec-writer"
2. 使用触发关键词（如 "创建 Spec"）
3. 重启 Claude Code 重新加载 Skill

### 问题 2：分类目录选择错误

**症状**：Spec 放入了错误的分类目录

**解决方案**：
1. 参考本文档的"文档类型与分类对应"表格
2. 根据 Spec 的主要目的选择目录
3. 如有疑问，优先选择 `03-功能实现`

### 问题 3：文件命名错误

**症状**：文件名不符合 `YYYYMMDD-任务描述` 格式

**解决方案**：
1. 检查日期格式（8位数字，无分隔符）
2. 检查分隔符（使用 `-` 而不是 `_`）
3. 确保任务描述简洁明确

## 📞 获取帮助

### 查看 Skill 文档

```bash
# 查看主 Skill 文件
cat .claude/skills/spec-writer/SKILL.md

# 查看模板
cat .claude/skills/spec-writer/TEMPLATES.md

# 查看示例
cat .claude/skills/spec-writer/EXAMPLES.md
```

### 查看现有 Spec

```bash
# 列出所有分类目录
ls spec/

# 查看特定分类目录
ls "spec/02-架构设计/"
ls "spec/03-功能实现/"
ls "spec/04-问题修复/"

# 搜索特定主题的 Spec
grep -r "关键词" spec/
```

## 🎉 总结

**Spec Writer Skill** 帮助你：

1. ✅ 按分类目录组织 Spec 文档
2. ✅ 规范化文档创建流程
3. ✅ 统一文档格式和命名
4. ✅ 提高文档质量和完整性
5. ✅ 确保开发前有明确的设计
6. ✅ 支持自动归档到 `06-已归档`

**记住**：
- 先 Spec，后开发
- 选择正确的分类目录（01-05）
- 严格遵循命名规范
- 使用标准模板
- 等待用户确认
- 执行完成后自动归档

---

**版本**：2.0
**创建日期**：2025-12-31
**更新日期**：2026-01-04
**维护者**：AI+专业评估系统项目组
